<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Shortie ‚Äî A question üíó</title>
<style>
  :root{
    --bg:#fff4f8; --card:#fff; --accent:#ff6b81; --muted:#6b6b6b;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Poppins",sans-serif;background:linear-gradient(180deg,var(--bg),#fff);-webkit-font-smoothing:antialiased}
  .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:22px}
  .card{
    width:100%;max-width:720px;background:var(--card);border-radius:18px;padding:28px 26px;text-align:center;
    box-shadow:0 18px 50px rgba(20,10,30,0.08);position:relative;overflow:visible;
    transform:translateY(0); transition:transform .45s cubic-bezier(.2,.9,.3,1);
  }
  h1{font-size:26px;margin:4px 0 8px;color:#222}
  p.lead{color:var(--muted);margin:6px 0 18px;font-size:15px}
  .controls{display:flex;gap:14px;justify-content:center;align-items:center;flex-wrap:wrap;position:relative;padding-top:6px}
  button{border:0;outline:0;padding:12px 20px;border-radius:999px;font-size:16px;cursor:pointer;box-shadow:0 10px 26px rgba(30,20,40,0.06);transition:transform .16s,box-shadow .16s}
  button:active{transform:translateY(1px)}
  #yes{background:linear-gradient(180deg,var(--accent),#ff4770);color:white;min-width:180px;font-weight:600;transform-origin:center}
  #no{background:#f3f3f4;color:#111;min-width:110px;position:absolute;right:18px;top:12px}
  /* reasons area - start hidden */
  .reasons{display:none;margin-top:18px;text-align:left;max-height:220px;overflow:auto;padding:10px;border-radius:12px;background:linear-gradient(180deg,#fff,#fff8fb);box-shadow:inset 0 1px 0 rgba(255,255,255,0.6)}
  .reason{display:flex;gap:10px;align-items:center;padding:8px;border-radius:10px;opacity:0;transform:translateY(12px) scale(.98)}
  .reason.show{opacity:1;transform:none;transition:all .36s cubic-bezier(.2,.9,.3,1)}
  .reason .dot{width:18px;height:18px;border-radius:6px;background:var(--accent);display:inline-flex;align-items:center;justify-content:center;color:white;font-size:11px}
  .reason p{margin:0;color:#333;font-size:14px}
  /* heart floaters */
  .hearts{position:fixed;left:0;top:0;right:0;bottom:0;pointer-events:none;overflow:hidden;z-index:2}
  .heart{position:absolute;width:18px;height:18px;background:linear-gradient(180deg,#ff7aa0,#ff4770);transform:rotate(-45deg);border-radius:4px 4px 16px 16px;opacity:.95}
  /* final box */
  .screen2{display:none;padding:24px;text-align:center}
  .screen2.show{display:block;animation:fadeIn .45s ease}
  @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}
  .finalBox{background:linear-gradient(180deg,#fff2f6,#fff0f4);padding:18px;border-radius:12px;margin-top:18px;color:#8a3140}
  .finalHeart{font-size:28px;margin-top:12px;display:inline-block}
  /* tooltip */
  .tooltip{position:fixed;padding:7px 10px;border-radius:10px;background:#222;color:#fff;font-size:13px;transform:translateY(-8px);white-space:nowrap;pointer-events:none;opacity:0;transition:opacity .12s,left .08s,top .08s}
  .tooltip.show{opacity:1}
  /* heartbeat pulse */
  @keyframes heartbeat {
    0% { transform: scale(1); }
    25% { transform: scale(1.12); }
    40% { transform: scale(0.98); }
    60% { transform: scale(1.06); }
    100% { transform: scale(1); }
  }
  .heartbeat { animation: heartbeat 900ms cubic-bezier(.2,.9,.3,1) infinite; }
  /* yes pulse (short) */
  @keyframes gentlePulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.06); }
    100% { transform: scale(1); }
  }
  #yes.pulse { animation: gentlePulse 900ms ease-in-out 3; }
  /* responsive */
  @media (max-width:520px){
    .card{padding:18px}
    #no{right:12px;top:10px}
  }
</style>
</head>
<body>
<div class="hearts" id="hearts"></div>

<div class="wrap">
  <div class="card" id="card">
    <div style="width:48px;height:48px;border-radius:12px;background:linear-gradient(180deg,#fff,#fff7fb);margin:0 auto 10px;display:flex;align-items:center;justify-content:center;box-shadow:0 10px 30px rgba(20,10,30,0.04)">
      <span style="font-size:22px">üíò</span>
    </div>

    <h1>Shortie‚Ä¶ will you be my girlfriend? üíó</h1>
    <p class="lead">I made this little thing just for you ‚Äî press Yes when you're ready. Try to catch the No button if you can üòÑ</p>

    <div class="controls" id="controls">
      <button id="yes">Yes ‚Äî I‚Äôd love to! ‚ú®</button>
      <button id="no">No</button>
      <div id="tooltip" class="tooltip" aria-hidden="true">Please?</div>
    </div>

    <div class="reasons" id="reasons" aria-live="polite" aria-hidden="true"></div>

    <!-- final box (shown after yes) -->
    <div class="screen2" id="screen2" aria-hidden="true">
      <div class="finalBox" role="status" aria-live="polite">
        <h3 style="margin:0;color:#8a3140">YAY - Thank you, Shortie!</h3>
        <p style="margin-top:8px;color:var(--muted)">I knew you'd say yes</p>
        <div class="finalHeart" id="finalHeart">‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è</div>
      </div>
      <div style="margin-top:16px">
        <button id="back" style="background:#fff;border:2px solid #ffdfe6;padding:10px 16px;border-radius:12px;cursor:pointer">Back</button>
      </div>
    </div>

  </div>
</div>

<canvas id="confetti" style="position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:9999"></canvas>

<script>
/* ---------- Messages (short & cute) ---------- */
const reasonsList = [
  "Your smile üò≠",
  "You make me laugh üòä",
  "We click ‚ú®",
  "I think about you üò≥",
  "I want to care for you ‚ù§Ô∏è",
  "We'd be cute ü´∂",
  "You make things better üå∏",
  "You deserve kindness üòå",
  "I already like you a lot üíó",
  "It feels right üíû"
];

const hoverMessages = [
  "Do you not like me? üòü",
  "Pretty please? ü•∫",
  "Don't run away üò≠",
  "Think again üëÄ",
  "I'll be really good üòá",
  "Consider this? ü•π",
  "Come onnn üò≠",
  "Just one yes? üå∏",
  "Why are you running? üò≠",
  "Please? ‚ù§Ô∏è"
];

/* ---------- Elements ---------- */
const reasonsEl = document.getElementById('reasons');
const noBtn = document.getElementById('no');
const yesBtn = document.getElementById('yes');
const tooltip = document.getElementById('tooltip');
const screen2 = document.getElementById('screen2');
const backBtn = document.getElementById('back');
const hearts = document.getElementById('hearts');
const card = document.getElementById('card');
const finalHeart = document.getElementById('finalHeart');

/* ---------- Build reasons (hidden) ---------- */
function buildReasons(){
  reasonsEl.innerHTML = ''; // ensure fresh
  reasonsList.forEach((r,i)=>{
    const el = document.createElement('div');
    el.className = 'reason';
    el.innerHTML = `<div class="dot">‚ù§</div><p>${r}</p>`;
    reasonsEl.appendChild(el);
  });
}
buildReasons();

/* ---------- Tooltip helper ---------- */
function showTooltip(text){
  tooltip.textContent = text;
  tooltip.classList.add('show');
  positionTooltip();
  setTimeout(()=> tooltip.classList.remove('show'),1200);
}
function positionTooltip(){
  const noRect = noBtn.getBoundingClientRect();
  const left = Math.max(8, noRect.left + noRect.width/2 - tooltip.offsetWidth/2);
  const top = Math.max(8, noRect.top - tooltip.offsetHeight - 8);
  tooltip.style.left = left + 'px';
  tooltip.style.top = top + 'px';
}

/* ---------- Reveal reasons one-by-one with cooldown ---------- */
let shown = 0;
let lastReveal = 0;            // timestamp for cooldown
const REVEAL_COOLDOWN = 900;   // ms between reveals

function revealReason(){
  const now = Date.now();
  if (shown >= reasonsList.length) return;
  if (now - lastReveal < REVEAL_COOLDOWN) return; // still cooling down

  // ensure reasons container becomes visible on first reveal
  if (reasonsEl.style.display === 'none' || reasonsEl.getAttribute('aria-hidden') === 'true') {
    reasonsEl.style.display = 'block';
    reasonsEl.setAttribute('aria-hidden','false');
  }

  const node = reasonsEl.children[shown];
  node.classList.add('show');
  node.style.transitionDelay = (shown * 80) + 'ms';
  shown++;
  lastReveal = now;
}

/* ---------- Move NO button to random safe place (on hover/touch/click) ---------- */
function moveNo(){
  const cardRect = card.getBoundingClientRect();
  const noRect = noBtn.getBoundingClientRect();
  const pad = 12;
  const maxX = Math.max(1, cardRect.width - noRect.width - pad);
  const maxY = Math.max(1, cardRect.height - noRect.height - pad - 20);
  let x,y,tries=0;
  const yesRect = yesBtn.getBoundingClientRect();
  do {
    x = Math.floor(Math.random() * (maxX - pad)) + pad;
    y = Math.floor(Math.random() * (maxY - pad)) + pad + 30;
    tries++;
    const yesRel = {x: yesRect.left - cardRect.left, y: yesRect.top - cardRect.top, w: yesRect.width, h: yesRect.height};
    const noRel = {x, y, w: noRect.width, h: noRect.height};
    const overlap = !(noRel.x + noRel.w < yesRel.x || noRel.x > yesRel.x + yesRel.w || noRel.y + noRel.h < yesRel.y || noRel.y > yesRel.y + yesRel.h);
    if(!overlap) break;
  } while(tries < 12);
  noBtn.style.position='absolute';
  noBtn.style.left = x + 'px';
  noBtn.style.top = y + 'px';

  // show short hover msg and reveal a reason (subject to cooldown)
  const msg = hoverMessages[Math.floor(Math.random() * hoverMessages.length)];
  showTooltip(msg);
  revealReason();
}

/* ---------- No button events ---------- */
// hover (desktop)
noBtn.addEventListener('mouseenter', moveNo);
// touchstart for mobile - only triggers move/reason once per touchstart (cooldown applies)
noBtn.addEventListener('touchstart', function(e){ e.preventDefault(); moveNo(); }, {passive:false});
// click fallback
noBtn.addEventListener('click', function(e){ e.preventDefault(); showTooltip("Nice try üòÖ"); moveNo(); });

/* ---------- Simple chime + sparkle sound using WebAudio ---------- */
function playYesChime(){
  try{
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const now = ctx.currentTime;
    const master = ctx.createGain();
    master.connect(ctx.destination);
    master.gain.setValueAtTime(0.0001, now);
    master.gain.exponentialRampToValueAtTime(0.22, now + 0.02);
    master.gain.exponentialRampToValueAtTime(0.0001, now + 0.9);

    const freqs = [880, 1100, 1320, 1760]; // ascending sparkle
    freqs.forEach((f, i) => {
      const o = ctx.createOscillator();
      o.type = 'sine';
      o.frequency.value = f;
      o.connect(master);
      o.start(now + i * 0.06);
      o.stop(now + i * 0.06 + 0.18);
    });

    const bass = ctx.createOscillator();
    const bassGain = ctx.createGain();
    bass.type = 'sawtooth';
    bass.frequency.value = 160;
    bassGain.gain.setValueAtTime(0.0001, now);
    bassGain.gain.exponentialRampToValueAtTime(0.16, now + 0.02);
    bassGain.gain.exponentialRampToValueAtTime(0.0001, now + 0.45);
    bass.connect(bassGain); bassGain.connect(ctx.destination);
    bass.start(now);
    bass.stop(now + 0.45);
  }catch(e){
    console.warn('Audio not available', e);
  }
}

/* ---------- Text-to-Speech: speak the final lines ---------- */
function speakFinalLines(){
  if (!('speechSynthesis' in window)) return;
  try {
    // Cancel any previous queued speech
    window.speechSynthesis.cancel();

    // First line
    const u1 = new SpeechSynthesisUtterance("YAY. Thank you, Shortie!");
    u1.rate = 0.95;
    u1.pitch = 1.05;

    // Second line
    const u2 = new SpeechSynthesisUtterance("I knew you'd say yes.");
    u2.rate = 0.95;
    u2.pitch = 1.05;

    // On end of first, speak second
    u1.onend = () => { try { window.speechSynthesis.speak(u2); } catch(e){ } };

    // Speak first (user gesture required - click qualifies)
    window.speechSynthesis.speak(u1);
  } catch(e) { console.warn('TTS failed', e); }
}

/* ---------- Yes behavior: chime + TTS + confetti + final box + heartbeat ---------- */
yesBtn.addEventListener('click', function(){
  // speak the final lines (this is the "person who spoke" feature)
  speakFinalLines();

  // play chime
  playYesChime();

  yesBtn.disabled = true; noBtn.disabled = true;
  startConfetti();
  yesBtn.animate([{transform:'scale(1)'},{transform:'scale(1.06)'},{transform:'scale(1)'}],{duration:360,easing:'cubic-bezier(.2,.9,.3,1)'});
  yesBtn.classList.add('pulse');
  setTimeout(()=> yesBtn.classList.remove('pulse'), 1200);

  setTimeout(()=> {
    // hide the controls and reasons, show final box (matching your screenshot text)
    document.querySelector('.reasons').style.display='none';
    document.querySelector('.controls').style.display='none';
    screen2.classList.add('show');
    spawnHearts(18);
    finalHeart.classList.add('heartbeat'); // continuous heartbeat
    yesBtn.textContent = "You said yes! ‚ù§";
  }, 420);
});

/* ---------- Back from final ---------- */
backBtn.addEventListener('click', function(){
  screen2.classList.remove('show');
  document.querySelector('.reasons').style.display='';
  document.querySelector('.controls').style.display='';
  yesBtn.disabled = false; noBtn.disabled = false;
  finalHeart.classList.remove('heartbeat');
  // reset shown reasons so they can reveal again if desired
  shown = 0;
  lastReveal = 0;
  Array.from(reasonsEl.children).forEach(node => node.classList.remove('show'));
  reasonsEl.style.display = 'none';
  reasonsEl.setAttribute('aria-hidden','true');
  yesBtn.textContent = "Yes ‚Äî I‚Äôd love to! ‚ú®";
});

/* ---------- Floating hearts ---------- */
function spawnHearts(count=6){
  for(let i=0;i<count;i++){
    const h = document.createElement('div');
    h.className = 'heart';
    const startX = Math.random()*100;
    h.style.left = startX + '%';
    h.style.top = (90 + Math.random()*10) + '%';
    hearts.appendChild(h);
    animateHeart(h);
    setTimeout(()=>{ try{ h.remove(); }catch(e){} }, 6000);
  }
}
function animateHeart(el){
  const duration = 4200 + Math.random()*1800;
  const start = performance.now();
  const fromY = parseFloat(el.style.top);
  const toY = -10 - Math.random()*20;
  const startX = parseFloat(el.style.left);
  const sway = 8 + Math.random()*18;
  function frame(t){
    const p = (t - start)/duration;
    if(p>=1){ el.style.top = toY + '%'; return; }
    const ease = 1 - Math.pow(1-p,3);
    el.style.top = (fromY + (toY-fromY)*ease) + '%';
    el.style.left = (startX + Math.sin(p*Math.PI*2)*sway) + '%';
    el.style.opacity = 1 - p;
    requestAnimationFrame(frame);
  }
  requestAnimationFrame(frame);
}

/* ---------- Confetti engine ---------- */
(function(){
  const canvas = document.getElementById('confetti');
  const ctx = canvas.getContext('2d');
  let W=canvas.width=innerWidth, H=canvas.height=innerHeight, parts=[];
  window.addEventListener('resize', ()=>{ W=canvas.width=innerWidth; H=canvas.height=innerHeight; });
  function rand(a,b){return Math.random()*(b-a)+a;}
  window.startConfetti = function(count=100){
    parts=[];
    for(let i=0;i<count;i++){
      parts.push({
        x: W/2 + rand(-40,40),
        y: H/3 + rand(-20,20),
        vx: rand(-6,6), vy: rand(-11,2),
        size: Math.floor(rand(6,12)),
        rot: rand(0,Math.PI*2), dr: rand(-0.12,0.12),
        color: ['#ff6b81','#ffd166','#7ae7c7','#b39eff'][Math.floor(rand(0,4))],
        life: Math.floor(rand(60,140))
      });
    }
    (function loop(){ ctx.clearRect(0,0,W,H); for(let i=parts.length-1;i>=0;i--){ const p=parts[i]; p.vy += 0.2; p.x += p.vx; p.y += p.vy; p.rot += p.dr; p.life--; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot); ctx.fillStyle=p.color; ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size*0.6); ctx.restore(); if(p.y>H+20||p.x<-50||p.x>W+50||p.life<=0) parts.splice(i,1);} if(parts.length) requestAnimationFrame(loop); })();
  }
})();

/* ---------- No automatic reveals on load; user must trigger ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  // ensure reasons are hidden and cleared on start
  reasonsEl.style.display = 'none';
  reasonsEl.setAttribute('aria-hidden','true');
  shown = 0;
  lastReveal = 0;
  Array.from(reasonsEl.children).forEach(node => node.classList.remove('show'));
  // gentle one-heart interval in background
  setInterval(()=> spawnHearts(1), 3500);
});

/* ---------- card hover bounce ---------- */
document.querySelector('.card').addEventListener('mouseenter', ()=> { document.querySelector('.card').style.transform = 'translateY(-6px)'; });
document.querySelector('.card').addEventListener('mouseleave', ()=> { document.querySelector('.card').style.transform = 'translateY(0)'; });

/* reposition tooltip on scroll/resize */
window.addEventListener('resize', positionTooltip);
window.addEventListener('scroll', positionTooltip);
</script>
</body>
</html>
